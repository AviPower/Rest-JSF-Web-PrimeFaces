<ui:composition template="/WEB-INF/template/LayoutPadron.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:o="http://omnifaces.org/ui">
	
	<ui:define name="titulo">Registro Compra</ui:define>
	<f:metadata>
		<f:viewParam name="compra" value="#{registroCompraBBean.compra}" converter="#{compraConverter}"/>
	</f:metadata>
	<ui:define name="cuerpo">

		<h:form>
			<h1>Compra</h1>

			<p:messages autoUpdate="true" closable="true" />

			<p:toolbar style="margin-top: 20px">

                                <p:toolbarGroup align="center">
                                <p:outputLabel value="Proveedor  " for="proveedor"/>
                                    <p:selectOneMenu id="proveedor" value="#{registroCompraBBean.proveedor}" style="width:300px"
                                         required="true" converter="#{proveedorConverter}">
	    			<f:selectItem itemLabel="Seleccione el Proveedor"/>
	    			<f:selectItems value="#{registroCompraBBean.proveedores}" var="proveedor"
	    				  itemValue="#{proveedor}" itemLabel="#{proveedor.nombre} #{proveedor.apellido}"/>
                                </p:selectOneMenu>
                                </p:toolbarGroup>
				<p:toolbarGroup align="right">
					<p:button value="Volver" outcome="/gestion/compra/ListadoCompra.xhtml"/>
				</p:toolbarGroup>
			</p:toolbar>

			<p:panelGrid columns="4" id="panel"
				style="width: 100%; margin-top: 20px" columnClasses="rotulo, campo">

				<p:outputLabel value="Producto" for="producto"/>
	    		<p:selectOneMenu id="producto" value="#{registroCompraBBean.compradetalle.producto}" style="width:300px"
                                         required="true" converter="#{productoConverter}">
	    			<f:selectItem itemLabel="Seleccione el Producto"/>
	    			<f:selectItems value="#{registroCompraBBean.productos}" var="producto"
                                               itemValue="#{producto}" itemLabel="#{producto.nombre}"
	    				  />
	    		</p:selectOneMenu>
	    		
				<p:outputLabel value="Cantidad" for="cantidad" />
				<p:inputText id="cantidad" value="#{registroCompraBBean.compradetalle.cantidad}"
					size="40"
					maxlength="70" />
                                
                                <p:commandButton value="Agregar" id="botonAgregar" actionListener="#{registroCompraBBean.agregarDetalle()}"
					 update="@form"/>
                                        <p:commandButton  icon= "ui-icon-cart" value="Carga por Archivo" id="botonArchivo" 
					 update="@form"/>
                                
			</p:panelGrid>
                        
                        
					<br />
                                        <h2>Articulos agregados al carrito </h2>

					<p:dataTable id="CompraTable" value="#{registroCompraBBean.compraDetalles}"
						var="detalles" emptyMessage="No agrego productos al carrito"
						style="width: 100%;">

						<p:column headerText="Codigo" style="width: 60px;">
							<h:outputText value="#{detalles.id}"/>
						</p:column>
                                            
						<p:column headerText="Producto" style="width: 180px;">
							<h:outputText value="#{detalles.producto.nombre}" />
						</p:column>

						<p:column headerText="Cantidad" style="width: 60px; text-align: center;">
							<h:outputText value="{detalles.cantidad}" />
						</p:column>


						<p:column headerText="Deshacer" style="width: 80px; text-align: center">
							
							<p:commandButton icon="ui-icon-trash" title="Eliminar"
								oncomplete="PF('confirmacionBorrar').show()" update="@form">
								
							</p:commandButton>
						</p:column>
					</p:dataTable>
		</h:form>
	
	</ui:define>
	
</ui:composition>
